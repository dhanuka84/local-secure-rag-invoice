---
apiVersion: api.cerbos.dev/v1
resourcePolicy:
  version: "default"
  resource: "template"
  rules:
    # Managers can promote templates that are in one of the allowed stages
    - actions: ["promote"]
      effect: EFFECT_ALLOW
      roles: ["manager"]
      condition:
        match:
          expr: request.resource.attr.stage in ["learned", "staging", "refined"]

    # Employees are never allowed to promote
    - actions: ["promote"]
      effect: EFFECT_DENY
      roles: ["employee"]
